<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang chủ - Electronic Store</title>
    <!-- Load Bootstrap trước khi load layout -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</head>
<body>
    <div id="layoutContainer">
        <!-- Layout will be loaded here -->
    </div>

    <script>
        // Utility function to properly load user layout with script execution
        async function loadUserLayoutWithScripts(contentLoader) {
            try {
                console.log('Loading user layout...');

                // Fetch the user layout
                const response = await fetch('/user/layouts/app.html');
                const layoutHtml = await response.text();

                // Create a temporary container to parse the HTML
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = layoutHtml;

                // Extract and execute scripts manually
                const scripts = tempDiv.querySelectorAll('script');

                // Inject layout into container
                document.getElementById('layoutContainer').innerHTML = layoutHtml;

                // Execute scripts manually to ensure they run
                scripts.forEach(script => {
                    if (script.src) {
                        // External script - check if already loaded
                        if (!document.querySelector(`script[src="${script.src}"]`)) {
                            const newScript = document.createElement('script');
                            newScript.src = script.src;
                            newScript.onload = () => console.log('External script loaded:', script.src);
                            document.head.appendChild(newScript);
                        }
                    } else {
                        // Inline script
                        const newScript = document.createElement('script');
                        newScript.textContent = script.textContent;
                        document.head.appendChild(newScript);
                    }
                });

                // Wait for layout and scripts to be fully loaded
                setTimeout(() => {
                    // Initialize Bootstrap dropdowns
                    const dropdownElementList = document.querySelectorAll('.dropdown-toggle');
                    const dropdownList = [...dropdownElementList].map(dropdownToggleEl => {
                        return new bootstrap.Dropdown(dropdownToggleEl);
                    });
                    console.log('Bootstrap dropdowns initialized:', dropdownList.length);

                    // Load page-specific content
                    if (contentLoader) {
                        contentLoader();
                    }
                }, 500);

            } catch (error) {
                console.error('Error loading layout:', error);
                document.getElementById('layoutContainer').innerHTML = `
                    <div class="alert alert-warning m-3">
                        <h4>Không thể tải giao diện đầy đủ</h4>
                        <p>Hiển thị phiên bản đơn giản:</p>
                    </div>
                    <div class="container">
                        <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
                            <div class="container">
                                <a class="navbar-brand" href="/user/home">
                                    <i class="fas fa-laptop me-2"></i>Electronic Store
                                </a>
                                <div class="navbar-nav">
                                    <a class="nav-link" href="/user/products">Sản phẩm</a>
                                    <a class="nav-link" href="/user/cart">Giỏ hàng</a>
                                </div>
                            </div>
                        </nav>
                        <div id="pageContent" class="py-4"></div>
                    </div>
                `;
                // Load content anyway
                if (contentLoader) {
                    setTimeout(contentLoader, 100);
                }
            }
        }

        // Load user layout and inject home content
        async function loadUserHomePage() {
            await loadUserLayoutWithScripts(loadHomeContent);
        }

        // Load home specific content
        function loadHomeContent() {
            console.log('Loading home content...');
            const pageContent = document.getElementById('pageContent');
            console.log('pageContent element:', pageContent);

            if (pageContent) {
                pageContent.innerHTML = `
                    <!-- Hero Section -->
                    <section class="hero-section">
                        <div class="container">
                            <div class="row align-items-center min-vh-75">
                                <div class="col-lg-6">
                                    <div class="hero-content">
                                        <div class="hero-badge">
                                            <i class="fas fa-bolt"></i>
                                            <span>Premium Electronics</span>
                                        </div>
                                        <h1 class="hero-title">
                                            Công nghệ <span class="gradient-text">Tiên tiến</span><br>
                                            Cho tương lai <span class="gradient-text">Số</span>
                                        </h1>
                                        <p class="hero-description">
                                            Khám phá bộ sưu tập thiết bị điện tử hàng đầu với chất lượng premium,
                                            thiết kế hiện đại và công nghệ đột phá cho cuộc sống thông minh.
                                        </p>
                                        <div class="hero-actions">
                                            <a href="/user/products" class="btn-premium btn-primary-premium">
                                                <span>Khám phá ngay</span>
                                                <i class="fas fa-arrow-right ms-2"></i>
                                            </a>
                                            <a href="#featured" class="btn-premium btn-outline-premium">
                                                <i class="fas fa-play me-2"></i>
                                                <span>Sản phẩm nổi bật</span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="hero-visual">
                                        <div class="tech-grid">
                                            <div class="tech-card floating-1">
                                                <div class="tech-icon">
                                                    <i class="fas fa-laptop"></i>
                                                </div>
                                                <div class="tech-info">
                                                    <span class="tech-title">Laptop Gaming</span>
                                                    <span class="tech-desc">RTX 4090 Series</span>
                                                </div>
                                            </div>
                                            <div class="tech-card floating-2">
                                                <div class="tech-icon">
                                                    <i class="fas fa-mobile-alt"></i>
                                                </div>
                                                <div class="tech-info">
                                                    <span class="tech-title">Smartphone 5G</span>
                                                    <span class="tech-desc">Pro Max Series</span>
                                                </div>
                                            </div>
                                            <div class="tech-card floating-3">
                                                <div class="tech-icon">
                                                    <i class="fas fa-headphones"></i>
                                                </div>
                                                <div class="tech-info">
                                                    <span class="tech-title">Audio Pro</span>
                                                    <span class="tech-desc">Noise Canceling</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Features Section -->
                    <section class="features-section" id="featured">
                        <div class="container">
                            <div class="section-header text-center">
                                <h2 class="section-title">Tại sao chọn ElectroTech?</h2>
                                <p class="section-subtitle">Chúng tôi cam kết mang đến trải nghiệm mua sắm công nghệ tuyệt vời nhất</p>
                            </div>
                            <div class="row g-4">
                                <div class="col-lg-4 col-md-6">
                                    <div class="feature-card">
                                        <div class="feature-icon">
                                            <i class="fas fa-shield-alt"></i>
                                        </div>
                                        <h3 class="feature-title">Bảo hành chính hãng</h3>
                                        <p class="feature-description">
                                            Tất cả sản phẩm đều có bảo hành chính hãng từ 12-36 tháng
                                            với dịch vụ hỗ trợ 24/7.
                                        </p>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-6">
                                    <div class="feature-card">
                                        <div class="feature-icon">
                                            <i class="fas fa-shipping-fast"></i>
                                        </div>
                                        <h3 class="feature-title">Giao hàng siêu tốc</h3>
                                        <p class="feature-description">
                                            Giao hàng nhanh chóng trong vòng 2-4 giờ tại nội thành
                                            và 24-48 giờ toàn quốc.
                                        </p>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-6">
                                    <div class="feature-card">
                                        <div class="feature-icon">
                                            <i class="fas fa-award"></i>
                                        </div>
                                        <h3 class="feature-title">Chất lượng Premium</h3>
                                        <p class="feature-description">
                                            Chỉ bán các sản phẩm chính hãng từ những thương hiệu
                                            công nghệ hàng đầu thế giới.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Categories Section -->
                    <section class="categories-section">
                        <div class="container">
                            <div class="section-header text-center">
                                <h2 class="section-title">Danh mục sản phẩm</h2>
                                <p class="section-subtitle">Khám phá bộ sưu tập đa dạng các thiết bị công nghệ cao</p>
                            </div>
                            <div class="row g-4">
                                <div class="col-lg-3 col-md-6">
                                    <div class="category-card">
                                        <div class="category-image">
                                            <div class="category-icon">
                                                <i class="fas fa-laptop"></i>
                                            </div>
                                            <div class="category-overlay">
                                                <span class="category-count">150+ sản phẩm</span>
                                            </div>
                                        </div>
                                        <div class="category-content">
                                            <h3 class="category-title">Laptop & PC</h3>
                                            <p class="category-description">Gaming, Workstation, Ultrabook</p>
                                            <a href="/user/products?category=laptop" class="category-link">
                                                Xem thêm <i class="fas fa-arrow-right ms-1"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="category-card">
                                        <div class="category-image">
                                            <div class="category-icon">
                                                <i class="fas fa-mobile-alt"></i>
                                            </div>
                                            <div class="category-overlay">
                                                <span class="category-count">80+ sản phẩm</span>
                                            </div>
                                        </div>
                                        <div class="category-content">
                                            <h3 class="category-title">Smartphone</h3>
                                            <p class="category-description">iPhone, Samsung, Xiaomi</p>
                                            <a href="/user/products?category=phone" class="category-link">
                                                Xem thêm <i class="fas fa-arrow-right ms-1"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="category-card">
                                        <div class="category-image">
                                            <div class="category-icon">
                                                <i class="fas fa-headphones"></i>
                                            </div>
                                            <div class="category-overlay">
                                                <span class="category-count">120+ sản phẩm</span>
                                            </div>
                                        </div>
                                        <div class="category-content">
                                            <h3 class="category-title">Audio & Âm thanh</h3>
                                            <p class="category-description">Headphones, Speakers, Earbuds</p>
                                            <a href="/user/products?category=audio" class="category-link">
                                                Xem thêm <i class="fas fa-arrow-right ms-1"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="category-card">
                                        <div class="category-image">
                                            <div class="category-icon">
                                                <i class="fas fa-keyboard"></i>
                                            </div>
                                            <div class="category-overlay">
                                                <span class="category-count">200+ sản phẩm</span>
                                            </div>
                                        </div>
                                        <div class="category-content">
                                            <h3 class="category-title">Phụ kiện</h3>
                                            <p class="category-description">Keyboard, Mouse, Webcam</p>
                                            <a href="/user/products?category=accessories" class="category-link">
                                                Xem thêm <i class="fas fa-arrow-right ms-1"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- CTA Section -->
                    <section class="cta-section">
                        <div class="container">
                            <div class="cta-card">
                                <div class="row align-items-center">
                                    <div class="col-lg-8">
                                        <div class="cta-content">
                                            <h2 class="cta-title">Sẵn sàng nâng cấp thiết bị của bạn?</h2>
                                            <p class="cta-description">
                                                Khám phá bộ sưu tập đầy đủ với hàng nghìn sản phẩm công nghệ cao,
                                                giá cả cạnh tranh và dịch vụ hỗ trợ tận tâm.
                                            </p>
                                        </div>
                                    </div>
                                    <div class="col-lg-4 text-lg-end text-center">
                                        <a href="/user/products" class="btn-premium btn-primary-premium btn-lg">
                                            <span>Mua sắm ngay</span>
                                            <i class="fas fa-shopping-bag ms-2"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <style>
                        /* Hero Section Styles */
                        .hero-section {
                            padding: 80px 0 120px;
                            background: linear-gradient(135deg, #FAFAFA 0%, #F8FAFC 100%);
                            position: relative;
                            overflow: hidden;
                        }

                        .hero-section::before {
                            content: '';
                            position: absolute;
                            top: 0;
                            right: 0;
                            width: 50%;
                            height: 100%;
                            background: radial-gradient(ellipse at center, rgba(59, 130, 246, 0.05) 0%, transparent 70%);
                        }

                        .min-vh-75 { min-height: 75vh; }

                        .hero-badge {
                            display: inline-flex;
                            align-items: center;
                            padding: 8px 16px;
                            background: rgba(59, 130, 246, 0.1);
                            border: 1px solid rgba(59, 130, 246, 0.2);
                            border-radius: 50px;
                            color: #3B82F6;
                            font-size: 14px;
                            font-weight: 600;
                            margin-bottom: 24px;
                        }

                        .hero-badge i {
                            margin-right: 8px;
                            font-size: 12px;
                        }

                        .hero-title {
                            font-size: 3.5rem;
                            font-weight: 800;
                            line-height: 1.1;
                            color: #121212;
                            margin-bottom: 24px;
                            letter-spacing: -0.025em;
                        }

                        .gradient-text {
                            background: linear-gradient(135deg, #3B82F6, #8B5CF6);
                            -webkit-background-clip: text;
                            -webkit-text-fill-color: transparent;
                            background-clip: text;
                        }

                        .hero-description {
                            font-size: 1.25rem;
                            line-height: 1.6;
                            color: #2E2E2E;
                            margin-bottom: 32px;
                            max-width: 500px;
                        }

                        .hero-actions {
                            display: flex;
                            gap: 16px;
                            align-items: center;
                            flex-wrap: wrap;
                        }

                        /* Premium Buttons */
                        .btn-premium {
                            display: inline-flex;
                            align-items: center;
                            padding: 14px 28px;
                            border-radius: 12px;
                            font-weight: 600;
                            font-size: 16px;
                            text-decoration: none;
                            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                            border: 2px solid transparent;
                        }

                        .btn-primary-premium {
                            background: linear-gradient(135deg, #3B82F6, #8B5CF6);
                            color: white;
                            box-shadow: 0 4px 14px rgba(59, 130, 246, 0.3);
                        }

                        .btn-primary-premium:hover {
                            transform: translateY(-2px);
                            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
                            color: white;
                        }

                        .btn-outline-premium {
                            background: white;
                            color: #2E2E2E;
                            border-color: #E0E0E0;
                        }

                        .btn-outline-premium:hover {
                            background: #FAFAFA;
                            border-color: #3B82F6;
                            color: #3B82F6;
                            transform: translateY(-1px);
                        }

                        /* Tech Grid Animation */
                        .tech-grid {
                            position: relative;
                            height: 400px;
                        }

                        .tech-card {
                            position: absolute;
                            background: white;
                            border-radius: 16px;
                            padding: 20px;
                            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                            border: 1px solid #E0E0E0;
                            display: flex;
                            align-items: center;
                            gap: 12px;
                            min-width: 250px;
                        }

                        .floating-1 {
                            top: 20px;
                            right: 60px;
                            animation: float-1 6s ease-in-out infinite;
                        }

                        .floating-2 {
                            top: 150px;
                            right: 20px;
                            animation: float-2 6s ease-in-out infinite 2s;
                        }

                        .floating-3 {
                            top: 280px;
                            right: 80px;
                            animation: float-3 6s ease-in-out infinite 4s;
                        }

                        @keyframes float-1 {
                            0%, 100% { transform: translateY(0px) rotate(0deg); }
                            50% { transform: translateY(-20px) rotate(1deg); }
                        }

                        @keyframes float-2 {
                            0%, 100% { transform: translateY(0px) rotate(0deg); }
                            50% { transform: translateY(-15px) rotate(-1deg); }
                        }

                        @keyframes float-3 {
                            0%, 100% { transform: translateY(0px) rotate(0deg); }
                            50% { transform: translateY(-25px) rotate(1deg); }
                        }

                        .tech-icon {
                            width: 48px;
                            height: 48px;
                            background: linear-gradient(135deg, #3B82F6, #8B5CF6);
                            border-radius: 12px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            color: white;
                            font-size: 20px;
                        }

                        .tech-info {
                            display: flex;
                            flex-direction: column;
                        }

                        .tech-title {
                            font-weight: 600;
                            color: #121212;
                            font-size: 14px;
                        }

                        .tech-desc {
                            color: #9E9E9E;
                            font-size: 12px;
                        }

                        /* Sections */
                        .features-section, .categories-section {
                            padding: 80px 0;
                        }

                        .section-header {
                            margin-bottom: 64px;
                        }

                        .section-title {
                            font-size: 2.5rem;
                            font-weight: 700;
                            color: #121212;
                            margin-bottom: 16px;
                            letter-spacing: -0.025em;
                        }

                        .section-subtitle {
                            font-size: 1.125rem;
                            color: #2E2E2E;
                            max-width: 600px;
                            margin: 0 auto;
                        }

                        /* Feature Cards */
                        .feature-card {
                            background: white;
                            padding: 32px;
                            border-radius: 16px;
                            border: 1px solid #E0E0E0;
                            text-align: center;
                            transition: all 0.3s ease;
                            height: 100%;
                        }

                        .feature-card:hover {
                            transform: translateY(-4px);
                            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.1);
                            border-color: #3B82F6;
                        }

                        .feature-icon {
                            width: 64px;
                            height: 64px;
                            background: linear-gradient(135deg, #3B82F6, #8B5CF6);
                            border-radius: 16px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            margin: 0 auto 24px;
                            color: white;
                            font-size: 24px;
                        }

                        .feature-title {
                            font-size: 1.25rem;
                            font-weight: 600;
                            color: #121212;
                            margin-bottom: 12px;
                        }

                        .feature-description {
                            color: #2E2E2E;
                            line-height: 1.6;
                        }

                        /* Category Cards */
                        .category-card {
                            background: white;
                            border-radius: 16px;
                            border: 1px solid #E0E0E0;
                            overflow: hidden;
                            transition: all 0.3s ease;
                            height: 100%;
                        }

                        .category-card:hover {
                            transform: translateY(-4px);
                            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.1);
                        }

                        .category-image {
                            position: relative;
                            height: 160px;
                            background: linear-gradient(135deg, #FAFAFA, #F8FAFC);
                            display: flex;
                            align-items: center;
                            justify-content: center;
                        }

                        .category-icon {
                            width: 64px;
                            height: 64px;
                            background: linear-gradient(135deg, #3B82F6, #8B5CF6);
                            border-radius: 16px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            color: white;
                            font-size: 24px;
                        }

                        .category-overlay {
                            position: absolute;
                            top: 12px;
                            right: 12px;
                            background: rgba(255, 255, 255, 0.9);
                            backdrop-filter: blur(10px);
                            padding: 4px 12px;
                            border-radius: 50px;
                            font-size: 12px;
                            font-weight: 600;
                            color: #2E2E2E;
                        }

                        .category-content {
                            padding: 24px;
                        }

                        .category-title {
                            font-size: 1.125rem;
                            font-weight: 600;
                            color: #121212;
                            margin-bottom: 8px;
                        }

                        .category-description {
                            color: #9E9E9E;
                            font-size: 14px;
                            margin-bottom: 16px;
                        }

                        .category-link {
                            color: #3B82F6;
                            font-weight: 600;
                            font-size: 14px;
                            text-decoration: none;
                            transition: all 0.3s ease;
                        }

                        .category-link:hover {
                            color: #8B5CF6;
                        }

                        /* CTA Section */
                        .cta-section {
                            padding: 80px 0;
                            background: linear-gradient(135deg, #121212, #2E2E2E);
                        }

                        .cta-card {
                            background: linear-gradient(135deg, #3B82F6, #8B5CF6);
                            padding: 48px;
                            border-radius: 24px;
                            color: white;
                        }

                        .cta-title {
                            font-size: 2rem;
                            font-weight: 700;
                            margin-bottom: 16px;
                        }

                        .cta-description {
                            font-size: 1.125rem;
                            opacity: 0.9;
                            margin-bottom: 0;
                        }

                        /* Responsive */
                        @media (max-width: 991.98px) {
                            .hero-title {
                                font-size: 2.5rem;
                            }

                            .tech-grid {
                                display: none;
                            }

                            .hero-actions {
                                justify-content: center;
                            }

                            .section-title {
                                font-size: 2rem;
                            }
                        }

                        @media (max-width: 767.98px) {
                            .hero-title {
                                font-size: 2rem;
                            }

                            .btn-premium {
                                padding: 12px 24px;
                                font-size: 14px;
                            }

                            .cta-card {
                                padding: 32px 24px;
                            }

                            .cta-title {
                                font-size: 1.5rem;
                            }
                        }
                    </style>
                `;

                // Hide skeleton when content is ready
                if (typeof window.hideSkeleton === 'function') {
                    window.hideSkeleton();
                }

                console.log('Home content loaded successfully');
            } else {
                console.error('pageContent element not found!');
                // Fallback: inject content directly into body
                document.body.innerHTML += `
                    <div class="container mt-5">
                        <div class="alert alert-info text-center">
                            <h2>Xin chào khách hàng!</h2>
                            <p>Chào mừng bạn đến với Electronic Store</p>
                        </div>
                    </div>
                `;
            }
        }

        // Load page when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            loadUserHomePage();
        });
    </script>
</body>
</html>